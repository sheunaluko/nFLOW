{"version":3,"sources":["core_modules/logger.js","module_resources/utils.js","core_modules/web_socket.js","core_modules/data_storage.js","core_modules/pipe_manager.js","core_modules/raw_analyzer.js","module_resources/global_params.js","core_modules/ui.js","core_modules/state_machine.js","core_modules/transformer.js","core_modules/logger_node.js","core_modules/simulator.js","core_modules/event_detector.js","module_bundle.js","module_resources/sm_utils.js","dev.js","wrtsm.js","module_resources/state_machine_elements.js","scripts/rose_gait_workflows.js","module_resources/sounds.js","module_resources/script_loader.js","index.js"],"names":["makeLogger","tag","stuff","console","log","join","logger","register","global_debug","util","cv","arr","std","avg","cv_matrix","matrix","num_els","length","result","Array","fill","e","el_array","map","set_debug","b","bug","i","debug","msg","sum","rms","Math","sqrt","variance","pow","take","coll","num","ret","arr_mult","x","y","perf","f","num_times","results","t0","performance","now","t1","range","a","len","first","d","last","zip_map","ks","vs","zip","xs","ys","dict_2_vec","k","push","number_or_self","val","Number","isNaN","d_map","dict_vals_2_num","diff","r","max","curr_max","min","curr_min","cycle_array","v","shift","std_percent_diff","tmp","NaN","spd_matrix","dom","s","document","createElement","set_inner_html","thang","HTMLElement","appendChild","innerHTML","flex_row","id_base","container","style","html","make_div_array","m","n","id","fn","new_id_base","row","col","el","id_from_loc","c","test_div_array","toString","app_clear","app","getElementById","firstChild","removeChild","app_render","colors","get_colors","Date","getTime","web_socket","url","connection","default_handler","data","data_handler","conn","WebSocket","addEventListener","event","send_json","type","bind","JSON","parse","func","obj","send","stringify","data_storage","name","session_id","toISOString","data_history","part_counter","save_interval_id","loaded_session","playback_speed_multiplier","stream_index","to_save","localStorage","setItem","rate","setInterval","flush_data","clearInterval","get_session","buffer_size","streaming","zero_time_axis","diffs","speed","start_stream_loop","stop_stream","delay","mod","setTimeout","t_1","csvContent","keys","Object","sort","dev","row_content","key","encodedUri","encodeURI","link","setAttribute","click","dataStr","encodeURIComponent","downloadAnchorNode","make_json_input","get_session_part_names","filter","includes","parts_names","getItem","merged","concat","apply","file_cb","evt","target","files","fname","replace","reader","FileReader","onloadend","readyState","DONE","readAsText","pipe_manager","from","to","set_data_handler","process_data","p","_to","connect","raw_analyzer","data_buffer","report","get_report","g_hist","g_line","get_field_average","obj_array","utils","params","global_x_len","make_y_series","make_x_series","create_static_multi_line_graph","opts","title","source","Bokeh","ColumnDataSource","Plotting","figure","sizing_mode","glyph","multi_line","field","line_color","add_tools","HoverTool","tooltips","line_policy","show","plot","create_multi_line_graph","x_len","series_array","series_len","bokeh_multi_stream","ds","xss","yss","setv","silent","trigger","Graph","series_vector","parent","multi_opts","background_fill_color","background_fill_alpha","border_fill_color","border_fill_alpha","multi_line_graph","ui","graphs","last_series_buffer","graph","graph_array","n_cols","n_rows","ceil","app_el","index","render_into_element","get_data_source","series_buffer","series","state_machine","gui_mode","debug_mode","init","sensor_buffer_size","buffer","default_data_obj","sensors","transitioners","transitioner_groups","STATE","sensors_gui_buffer","ui_mapping","state","sensor_order","l1","level","l","set_sensor_order","add_graph","slice","get_sensor_last_N","transitioner","detector","applicator","group","group_status","sensor_id","run_sensor","transitioner_id","update_buffer_with_data_object","run_sensors","run_transitioner","handle_sensor_buffer","time","random_data_obj","random","count","transformer","logger_node","simulator","mode","stream_interval","send_val","sin","multiplier","offset","getSeconds","z","power","map_f_on_dict","reduce_val","isArray","reduce","reduce_dict","test_dict","acc","gyr","foo","bar","happy","linearize_dict","flattened","linearize","event_detector","baseline_data","found_baseline","baseline_buffer_size","history_buffer_size","init_baseline_buffer","init_history_buffer","transformed_packet","spd","add_to_baseline","baseline_buffer","baseline_buffer_full","process_post_baseline","process_pre_baseline","history_buffer","mods","smu","transformers","sm","vars","wrtsm","window","sme","dev_a","dev_b","field_diff","is_dev_b","is_dev_a","buf","test_turn_on","is_on","test_turn_off","flow","test_storage_persist","ws","pm","start_saving","stop_saving","test_storage_replay","load_session","ra","start_stream","test_state_machine","rg","initialize","add_sensor","add_transitioner","test_state_machine_gui","init_gui","playback_gui","graph_dances","g1","counter","acc_x","acc_y","graph_sm_test","sizes","size","test_cycle","run_debug_cycle","bar_graph","EW","sounds","ctx","AudioContext","osc","freq","gainVal","gain","createOscillator","frequency","value","createGain","destination","start","beep_time","beep_dic","beep","stop","load_script","cb","script","onreadystatechange","onload","src","getElementsByTagName","load_css","rel","href","load_api","ls","Event","dispatchEvent","load_time"],"mappings":"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","file":"wrtsm.map","sourceRoot":"../src","sourcesContent":["\nexport function makeLogger(tag) { \n    return function(...stuff) { \n\tconsole.log(\"[\" + tag + \"]:: \" + stuff.join())\n    }\n} \n\n\nvar logger = {} \n\nlogger.register = function(tag) { \n    logger[tag] = makeLogger(tag)\n} \n\n\nexport {logger}  \n","//Tue Oct  2 18:06:09 PDT 2018\n//General JS utils file \n//would like to try creating soft?hard? links so that the utils files can be shared \n\nimport {logger} from \"../core_modules/logger.js\"\n\n\nvar global_debug = true \n\nvar util = {} \n\nutil.set_debug = function(b) { \n    global_debug = b \n} \n\nutil.bug = function(tag,...msg) { \n    if (global_debug) { \n\tconsole.log(\"<- \" + tag + \" ->\" )\n\tfor (var i = 0 ; i < msg.length ; i++) { \n\t    console.log(msg[i])\n\t}\n\tconsole.log(\"<- \" + tag + \" ->\" )\n    }\n}\n\nlogger.register(\"bug\") \n\nutil.debug = function(msg) { \n    if (global_debug) {\n\tlogger.bug(msg)\n    }\n}\n\n\n\nutil.avg = function(arr) { \n    var sum = 0;\n    for( var i = 0; i < arr.length; i++ ){\n\tsum += arr[i]\n    }\n    return sum/arr.length \n}\n\nutil.rms = function(arr) { \n    var sum = 0;\n    for( var i = 0; i < arr.length; i++ ){\n    \tsum += arr[i]*arr[i]\n    }\n    return Math.sqrt(sum/arr.length)\n}\n\n\n\nutil.variance = function(arr) { \n    var avg = util.avg(arr)\n    var sum = 0 \n    for( var i = 0; i < arr.length; i++ ){\n\tsum += Math.pow(arr[i] - avg, 2)\n    }\n    return sum/arr.length \n} \n\n\nutil.std = function(arr) { \n    return Math.sqrt(util.variance(arr))\n} \n\nutil.take = function(coll,num) { \n    var ret = Array(num).fill(0) \n    for (var i =0;i<num; i++) { \n\tret[i] = coll[i]\n    }\n    return ret \n} \n\nutil.arr_mult = function(arr,x) { \n    return arr.map( y => y /x ) \n}\n\nutil.perf = function(f) { \n    var num_times = 20000\n    var results = Array(num_times).fill(0) \n    for (i = 0 ; i < num_times ; i++ ) { \n\tvar t0 = performance.now();\n\tvar result = f() \n\tvar t1 = performance.now();\n\tresults[i] = t1 - t0 \n    } \n    return avg(results) \n} \n\nutil.range = function(a,b) { \n    var len = b - a \n    var ret = Array(len).fill(0)  ; \n    for (var i = 0 ; i< len ; i++) {  \n\tret[i] = a + i \n    }\n    return ret \n    \n} \n\nutil.first = function(d) { \n    return d[0]\n} \n\n\nutil.last = function(d) { \n    return d[d.length - 1 ] \n} \n\nutil.zip_map = function(ks,vs) { \n    var result = {} \n    for (var i = 0 ; i < ks.length; i ++ ) { \n\tresult[ks[i]] = vs[i]\n    }\n    return result\n}\n\nutil.zip = function(xs,ys) { \n        return xs.map(function(x,i) { \n\t    return [x, ys[i]]\n\t}) \n}\n\nutil.dict_2_vec = function(d) { \n    var ret = [] ; \n    for (var k in d) { \n\tret.push([ k, d[k] ]) \n    } \n    return ret \n}\n\nutil.number_or_self = function(d) { \n    var val = Number(d) \n    if (isNaN(val)) {\n\treturn d \n    } else { \n\treturn val \n    } \n}\n\nutil.d_map = function(d,f) { \n    for (var k in d) {\n\td[k] = f(d[k])\n    }\n    return d \n}\n\nutil.dict_vals_2_num = function(d) { \n    return util.d_map(d,util.number_or_self) \n}\n    \n\nutil.diff = function(d) { \n    var r =   Array(d.length - 1).fill(0) \n    for (var i = 1 ; i < d.length ; i ++ ) { \n\tr[i-1] = d[i] - d[i-1]\n    }\n    return r \n}\n\n\nutil.max = function(d) { \n    var curr_max = d[0] \n    \n    for (var i=1;i<d.length;i++) { \n\tif (d[i] > curr_max) { curr_max = d[i] }\n    } \n    \n    return curr_max \n} \n\n\nutil.min = function(d) { \n    var curr_min = d[0] \n    \n    for (var i=1;i<d.length;i++) { \n\tif (d[i] < curr_min) { curr_min = d[i] }\n    } \n    \n    return curr_min\n    \n} \n\n\nutil.cycle_array = function(a,v) { \n    a.push(v)\n    a.shift() \n    return a \n} \n\nutil.std_percent_diff = function(arr) { \n    // Meant to be a magnitude normalized average derivative of an array \n    // calculates the vector of percentage differences (consecutive indeces) \n    // then gets the std of those \n    var tmp = Array(arr.length - 1 ).fill(NaN) \n    for (var i =0 ; i < tmp.length ; i ++ ) { \n\ttmp[i] =  (arr[i+1]-arr[i])/arr[i]\n    }\n    \n    return util.std(tmp)\n}\n\n\nfunction cv(arr) { \n    return util.std(arr)/util.avg(arr)\n}\n\nfunction cv_matrix(matrix) { \n\n    let num_els = matrix[0].length \n    var result = Array(num_els).fill(null)\n    \n    for (var e =0; e < num_els ; e ++ ) { \n\tlet el_array = matrix.map( arr => arr[e]  ) \n\tresult[e] = cv(el_array)\n    }\n    \n    return result\n} \n\nutil.spd_matrix = function(matrix) { \n    // foo\n\n    let num_els = matrix[0].length \n    var result = Array(num_els).fill(null)\n    \n    for (var e =0; e < num_els ; e ++ ) { \n\tlet el_array = matrix.map( arr => arr[e]  ) \n\tresult[e] = util.std_percent_diff(el_array)\n    }\n    \n    return result\n} \n\nutil.cv = cv\nutil.cv_matrix = cv_matrix \n\n\n\n\n\n\n\n// define ui utilities now ------------> \n\n\n\n\nutil.dom = function(s) { \n    return document.createElement(s) \n} \n\nutil.set_inner_html = function(d,thang) { \n    if (thang instanceof HTMLElement) { \n\td.appendChild(thang) \n    } else { \n\td.innerHTML = thang \n    } \n    \n} \n\nutil.flex_row = function(num,id_base,f) { \n    var container, i \n\n    container = util.dom(\"div\")  \n    //container.className = \"flex-row\"  // see styles.css   \n    \n    container.style = \"display : flex ; flex-wrap : nowrap ; flex-direction : row ; flex-grow : 1 \"\n        \n    for (i =0 ; i < num ; i ++ ) { \n\tvar d = util.dom(\"div\") \n\td.style = \"flex-grow : 1\"\n\tvar html = f(i,d) \n\tif (html) { \n\t    util.set_inner_html(d, html) \n\t} \n\tcontainer.appendChild(d) \n    } \n\t\n    return container  \n     \n}\n\n\n/* \n * Create a flexbox of divs [m,n] in shape \n * @param {Function} f - accepts row, column, and HTMLelement. Can either mutate the el or return an new el (which will be appended to div at spot r,c) or return String (which will be set to innerHTML) \n */ \nutil.make_div_array = function(m,n,id_base,f) { \n    var container, i \n    \n    container = util.dom(\"div\")  \n    //container.className = \"flex-column\"  // see styles.css  \n    container.id = id_base \n    \n    container.style = \"width: 100% ; height : 100% ; display : flex ; flex-wrap : nowrap ; flex-direction : column \"\n    \n    // now we will add in the child elements \n    for (i =0 ; i < m ; i ++ ) { \n\t\n\t//f is a function which takes a row and column and element \n\t//build a function that takes just a col with row hard coded \n\t//and returns f(r,col)\n\tvar fn = function(col,el) {\n\t    return f(i,col,el) \n\t}\n\t\n\tvar new_id_base = id_base + \"_\" +  i + \",\" \n\tvar row = util.flex_row(n,new_id_base , fn )\n\tcontainer.appendChild(row) \n    }\n    \n    return container\n    \n\n} \n\nutil.id_from_loc = function(m,n,c) { \n    return c*m + n   // intersing that this function needs arg c, which is (static) number of cols \n}\n\nutil.test_div_array = function(m,n) { \n    var f = function(r,c,el) { \n\treturn (util.id_from_loc(r,c,n)).toString()\n    } \n\n    return util.make_div_array(m,n,\"foo\", f) \n    \n} \n\t\n\nutil.app_clear = function() { \n    var app = document.getElementById(\"app\");\n    while (app.firstChild) {\n\tapp.removeChild(app.firstChild);\n    }   \n}\n\nutil.app_render = function(el) { \n    util.app_clear() \n    var app = document.getElementById(\"app\")  \n    app.appendChild(el) \n}\n\n\nvar colors = [\"black\" , \"blue\" , \"red\" , \"green\" , \"yellow\" , \"orange\"]\n\nutil.get_colors = function(num) { \n    return util.take(colors, num) \n}\n\n\nutil.now = function() { \n    return (new Date()).getTime()    \n}\n///   extensions \n\n\n// Array.prototype.first = function(arr) { \n//     return arr[0] \n// }\n\n\nexport {util} \n","// Sat Sep 29 18:31:15 PDT 2018\n\nimport {makeLogger} from \"./logger.js\"\nimport {util} from \"../module_resources/utils.js\"\n\n/**\n * Manages the websocket connection to an incoming data stream.\n *\n * @param {String} url - The websocket url to connect to, e.g. ws://localhost:1234\n */\nexport default class web_socket {\n    \n    constructor(url) { \n\tthis.url = url ;  \n\tthis.connection = null ;  \n\tthis.log = makeLogger(\"WS\")\n\tthis.default_handler = function(data) { \n\t    this.log(\"No data handler has been defined!\") \n\t} \n\tthis.data_handler = this.default_handler \n    } \n    \n    /**\n     * Connect to remote websocket server. Upon success, registers the websocket connection\n     * as \"client\" with the server, enables streaming, and this.logs to console. \n     */ \n    connect() { \n\tvar conn  = new WebSocket(this.url) ; \n\t// Connection opened\n\tconn.addEventListener('open', (function (event) {\n\t    this.log(\"Connection to \" + this.url + \" successful. Registering client with server.\")\n\t    this.send_json({type: \"register\" , data : \"client\" })\n\t    this.send_json({type: \"control\"  , data : \"start\"  }) \n\t}).bind(this)) //bind is necessary for web_socket class vs WebSocket instance! \n\n\t\n\t// Listen for messages\n\tconn.addEventListener('message', (function (event) {\n\t    //this.log(\"Received msg: \" + event.data) \n\t    this.data_handler(util.dict_vals_2_num(JSON.parse(event.data))) //parse json and convert nums\n\t}).bind(this)) //bind is necessary for web_socket class vs WebSocket instance! \n\t\n\tthis.connection = conn ; \n    } \n    \n    /** \n     * Start accepting incoming raw data objects.\n     */ \n    start_stream() { \n\tthis.send_json({type : \"control\" , data : \"start\" } ) \n    }\n\n    /** \n     * Stop accepting incoming raw data objects.\n     */ \n    stop_stream() { \n\tthis.send_json({type : \"control\" , data : \"stop\" } ) \n    }\n\n    /** \n     * Sets the data_handler attribute, which determines what the socket does to incomin data.\n     * @param {Function} func - Function which accepts ONE raw data object {..} and processes it.\n     */ \n    set_data_handler(func) { \n\tthis.data_handler = func ; \n    }\n\n    /** \n     * Sends JSON data through socket. \n     * @param {Object} obj - Data object to send \n     */ \n    send_json(obj) { \n\tthis.connection.send(JSON.stringify(obj))\n    }\n\n    \n    \n}\n\n","//Tue Oct  2 10:12:11 PDT 2018\n\nimport {makeLogger} from \"./logger.js\"\nimport {util} from \"../module_resources/utils.js\"\n\n/**\n * \n * \n */\n\nexport default class data_storage {\n\n    /**\n     * Manages data persistence and replay/simulation. Uses browser based local storage. \n     * @param {String} name - Session identifier, use null for default time string\n     */ \n    constructor(name) { \n\tthis.session_id = name || (new Date()).toISOString()\n\tthis.data_history = [] \n\tthis.part_counter = 1 \n\tthis.save_interval_id = null \n\tthis.loaded_session = null \n\tthis.playback_speed_multiplier = 1\n\t\n\tthis.log = makeLogger(\"DS\")\n\tthis.default_handler = function(data) { \n\t    this.log(\"No data handler has been defined!\") \n\t} \n\tthis.data_handler = this.default_handler \n\tthis.stream_index = 0 \n    } \n    \n    /**\n     *  Persists a chunk of data to localStorage. Uses session name + part_number as identifier\n     */ \n    flush_data() { \n\tvar to_save = JSON.stringify(this.data_history)\n\tname    = this.session_id + \"_part\" + this.part_counter.toString() \n\tthis.data_history = [] \n\tlocalStorage.setItem(name, to_save) \n\tthis.part_counter += 1 \n\tthis.log(\"Saved data chunk: \" + name ) \n    } \n    \n    /**\n     * Start saving data to localStorage. Data is saved in chunks called 'parts'. \n     * @param {Number} rate - The rate to flush data to localStorage in SECONDS \n     */ \n    start_saving(rate) { \n\tthis.save_interval_id = setInterval(  (function(){this.flush_data()}).bind(this) , rate*1000)\n\tthis.log(\"Saving started for session: \" + this.session_id) \n    } \n\n    /**\n     * Stop saving data to localStorage\n     */ \n    stop_saving() { \n\tclearInterval(this.save_interval_id) \n\tthis.log(\"Saving stopped for session: \" + this.session_id) \n    } \n    \n    /** \n     * Main data handler. Will append the incoming data to the data_history array \n     * @param {Object} obj - The data obj to add \n     */\n    process_data(obj) { \n\tthis.data_history.push(obj) \n    } \n\n    /** \n     * Loads a data storage session from localStorage. Returns Array. \n     */\n    load_session() { \n\tthis.log(\"Loading session...\")\n\tthis.loaded_session = get_session(this.session_id)  // see definition below \n\tthis.stream_index = 0 \n\tthis.buffer_size = this.loaded_session.length\n\tthis.streaming = false \n\tthis.zero_time_axis() \n\tthis.diffs = util.diff( this.loaded_session.map( d => d[\"time\"] )  )\n\tthis.log(\"Session loaded: \" + this.session_id) \n    } \n\n\n    /** \n     * Set the data_handler for data replay/simulation \n     * @param {Function} f - The data handler function  \n     */\n    set_data_handler(f) { \n\tthis.data_handler = f \n    } \n    \n    /** \n     * Start streaming the session that was previously loaded from localStorage \n     */\n    start_stream(speed) { \n\tthis.stream_index =  0 \n\tthis.streaming = true \n\tthis.playback_speed_multiplier = speed || 1 \n\tthis.start_stream_loop() \n\n    } \n    \n    /** \n     * Stream single packet\n     */\n    stream_single_packet() { \n\tif (this.stream_index < this.buffer_size  ) { \t\n\t    //get the data\n\t    var val = this.loaded_session[this.stream_index]\n\t    //send the data\n\t    this.data_handler(val) \n\t    //increment the stream index \n\t    this.stream_index += 1 \n\t    return val \n\t} else { \n\t    this.stop_stream() \n\t} \n\t\n\n    } \n    \n    \n    /** \n     * Helper function for start_stream() \n     */\n    start_stream_loop() { \n    \t//when starting, this.index is 0, this.diffs is defined \n\tif (this.streaming) { \n\t    //get the data\n\t    var val = this.loaded_session[this.stream_index]\n\t    //send the data\n\t    this.data_handler(val) \n\t    \n\t    if (this.stream_index == this.buffer_size - 1 ) { \n\t\t//on the last data point  \n\t\t//significant b/c the diff array is finished \n\t\t//so we stop streaming \n\t\tthis.stop_stream() \n\t\t\n\t    } else { \n\t\t//not on the last data point \n\t\t//now acces the next diff \n\t\tvar delay = this.diffs[this.stream_index]\n\t\t//increment the stream_index \n\t\tthis.stream_index += 1 \n\t\t//schedule the loop again \n\t\tvar mod =  this.playback_speed_multiplier \n\t\tsetTimeout( (function() {this.start_stream_loop()}).bind(this) , delay*mod)\n\t    }\n\t    \n\t}\n\t\n    }\n\t\t\n    \n    /** \n     * Zero the time axis of the data session \n     */\n    zero_time_axis() { \n\tthis.log(\"Zeroing time axis\") \n\tif (!this.loaded_session.length) { \n\t    throw(\"Session must be loaded!\")\n\t} else { \n\t    //get first time point \n\t    var t_1  = util.first(this.loaded_session)[\"time\"] \n\t    //now we subtract t_1 from all time points \n\t    this.loaded_session.map( function(d) { \n\t\td[\"time\"] = d[\"time\"] - t_1 \n\t\treturn d \n\t    })\n\t    this.log(\"Done\")\n\t}\n\t\n    } \n\n\n\n    /** \n     * Stop streaming the session that was previously loaded from localStorage \n     */\n    stop_stream() { \n\tthis.streaming = false \n\tthis.stream_index =  0 \n\tthis.log(\"Stream finished.\") \n    } \n\n    \n    \n    /** \n     * Makes csv string from this.loaded_session \n     */\n    to_csv(name) { \n\tthis.log(\"Creating csv file for: \" + this.session_id) \n\tlet csvContent = \"data:text/csv;charset=utf-8,\";\n\t\n\t//figure out the keys in the data objects \n\tlet keys = Object.keys(this.loaded_session[0]).sort()\n\t\n\t//write csv header \n\tcsvContent += ( keys.join(\",\") + \"\\n\" ) \n\t\n\t//then loop through the structure \n\tfor (var i =0 ; i < this.loaded_session.length ; i ++) { \n\t    var data = this.loaded_session[i]\n\t    if (data.dev == \"B\" ) { \n\t\tvar row_content = []\n\t\t//loop through keys to build the row \n\t\tfor (var k = 0 ; k < keys.length ; k ++ ) { \n\t\t    var key = keys[k] \n\t\t    var val = data[key]\n\t\t    row_content.push(data[key]) \n\t\t}\n\t\tcsvContent += (row_content.join(\",\") + \"\\n\" ) \n\t    }\n\t} \n\t\n\tvar encodedUri = encodeURI(csvContent);\n\tvar link = document.createElement(\"a\");\n\tlink.setAttribute(\"href\", encodedUri);\n\tlink.setAttribute(\"download\", (name || this.session_id)   + \".csv\");\n\tlink.click();\n\t\n\t\n    } \n\n    /** \n     * Makes and downloads json string from this.loaded_session \n     */\n    to_json(name) { \n\tthis.log(\"Creating json file for: \" + this.session_id) \n\tvar dataStr = \"data:text/json;charset=utf-8,\" + encodeURIComponent(JSON.stringify(this.loaded_session)) \n\tvar downloadAnchorNode = document.createElement('a');\n\tdownloadAnchorNode.setAttribute(\"href\",     dataStr);\n\tdownloadAnchorNode.setAttribute(\"download\", (name || this.session_id) + \".json\");\n\tdownloadAnchorNode.click();\n    }\n    \n    \n    /** \n     * Loads json data into local storage \n     */\n    load_json() { \n\tvar i = make_json_input() \n\ti.click() \n\treturn i\n    }\n    \n    \n}\n\n\n// define some helpers \nfunction get_session_part_names(id) { \n    return Object.keys(localStorage).filter( s => s.includes(id) ).sort() \n} \n    \nfunction get_session(id) { \n    var parts_names = get_session_part_names(id) \n    // part names are sorted already \n    var tmp = parts_names.map( function(name) { \n\treturn JSON.parse(localStorage.getItem(name))\n    }) \n    \n    var merged = [].concat.apply([], tmp);\n    return merged \n}\n\n\nfunction file_cb(evt) { \n    var f = evt.target.files[0]\n    var fname = f.name.replace(\".json\",\"\")\n    var reader = new FileReader() \n    reader.onloadend = function(evt) { \n\tif (evt.target.readyState == FileReader.DONE) {\n\t    localStorage.setItem(fname, evt.target.result) \n\t    console.log(\"[DS]:: Saved item to local storage: \" + fname )\n\t} else { \n\t    console.log(\"[DS]:: error reading.. \") \n\t    console.log(evt) \n\t} \n    }\n    reader.readAsText(f) \n}\n\n\nfunction make_json_input() {\n    var i =   document.createElement(\"input\")\n    i.type = \"file\" \n    i.addEventListener(\"change\", file_cb ) \n    return i \n} \n","//Tue Oct  2 10:12:11 PDT 2018\n\nimport {makeLogger} from \"./logger.js\"\n\n/**\n * Manages the flow of streaming data between various modules of RoseGait\n * e.g. pipe_manager.connect(web_socket, data_storage) \n */\nexport default class pipe_manager {\n    \n    constructor() { \n\tthis.log = makeLogger(\"PM\")\n    } \n    \n    \n    /**\n     * Connects a streaming output data source to a streaming input source. \n     * @param {Object} from - data source (emits data). Must implement method `set_data_handler` \n     * and have member default_handler\n     * @param {Object} to -   data sink   (consumes data). Must implement method `process_data` \n     */ \n    connect(from, to) { \n\tfrom.set_data_handler(  (function(d) {to.process_data(d)}).bind(to) ) \n\tlet p = new pipe_manager() \n\tlet f = {'connect' : function(_to) { return p.connect(to,_to) }}\n\treturn f // for recursive connects... p.connect(1,2).connect(3).connect(4)...\n    } \n\n    /**\n     * Disconnects a streaming output data source from a streaming input source. \n     * @param {Object} from - data source (emits data). Must implement method `set_data_handler` \n     * and have member default_handler\n     * @param {Object} to -   data sink   (consumes data). Must implement method `process_data` \n     */ \n    disconnect(from, to) { \n\tfrom.set_data_handler(from.default_handler)\n    } \n\n    \n}\n\n\n\n\n","//Tue Oct  2 10:12:11 PDT 2018\n\nimport {makeLogger} from \"./logger.js\"\nimport util from \"../module_resources/utils.js\"\n\n/**\n * \n * \n */\n\nexport default class raw_analyzer {\n\n    /**\n     * Provides insights and attributes about raw data stream. \n     * e.g. checks for dropped samples \n     */ \n    constructor() { \n\tthis.data_history  =  [] \n\tthis.log = makeLogger(\"RA\")\n    } \n    \n    /**\n     * Processes a data packet \n     * @param {Object} obj - Data object to process \n     */ \n    process_data(obj) { \n\tthis.data_history.push(obj) \n\tthis.log(\"Received data!\") \n    } \n    \n    /**\n     * Produce report (logged to console for now) \n     */ \n    produce_report() { \n\tvar data_buffer = this.data_history \n\tvar report = get_report(data_buffer) \n\tthis.log(\"Printing report: \" ) \n\tthis.log(JSON.stringify(report) ) \n\treturn report \n    } \n    \n    /**\n     * (UNSTABLE ) Show ditribution for field  \n     */ \n    dist_field(f) { \n\t//clear_plot_div() \n\t\n\tvar data = this.data_history.map( e => e[f] ) \n\t\n\tg_hist(data,\"Distribution for: \" + f)     \n\t\n    }\n\n    /**\n     * (UNSTABLE) Show time series for field \n     */ \n    line_field(f) { \n\tvar data = this.data_history.map( e => e[f] ) \n\tg_line(data,\"Time series for: \" + f)     \n\t\n    }\n\n    \n} \n\n\n\nfunction get_field_average(obj_array,f) { \n    return  utils.avg(obj_array.map( obj => obj[f] )) \n} \n\n\n\n\nfunction get_report(data_buffer) { \n    return { \n\t    'len'       : data_buffer.length  , \n\t    'acc_x_avg' : get_field_average(data_buffer, \"acc_x\"), \n\t    'acc_y_avg' : get_field_average(data_buffer, \"acc_y\"), \n\t    'acc_z_avg' : get_field_average(data_buffer, \"acc_z\"), \n\t    'gyr_x_avg' : get_field_average(data_buffer, \"gyr_x\"), \n\t    'gyr_y_avg' : get_field_average(data_buffer, \"gyr_y\"),\n\t    'gyr_z_avg' : get_field_average(data_buffer, \"gyr_z\") \t    \n    }\n} \n\n","\n\n\nvar params = \n    { \n\tglobal_x_len : 200 \n\t\n\t\n\t\n    }\n\n\nexport { params } \n    \n","import {params} from \"../module_resources/global_params.js\" \nimport {util}     from \"../module_resources/utils.js\" \n\n\n\nfunction make_y_series(len) { \n    return Array(len).fill(0) \n}\n\nfunction make_x_series(len) { \n    return util.range(-len, 0).map( x => x/100 ) // the /100 is hax for now for streaming\n}\n\nfunction create_static_multi_line_graph(container,opts) { \n\tvar { xs, ys , title  } = opts \n\t\n\t//will use indeces for x arrays if not provided \n\tif (! xs ) { \n\t\txs =  [] \n\t\tfor (var i =0; i< ys.length ; i ++)  { \n\t\t\txs.push(util.range(0, ys[0].length ) ) \n\t\t}\n\t}\n\n\tvar source = new Bokeh.ColumnDataSource( {\n\tdata : {xs : xs, ys : ys }\n    })\n    \n    // make the plot and add some tools\n    //var tools = \"pan,crosshair,wheel_zoom,box_zoom,reset,save\";\n\n    // WOW ! -- how lucky to find sizing_mode : stretch_both lmao \n    // https://github.com/bokeh/bokeh/issues/4958\n    \n    var p = Bokeh.Plotting.figure({ title: title,sizing_mode : 'stretch_both' })\n    \n    //add the multiline \n    var glyph = p.multi_line({ field: \"xs\" }, { field: \"ys\" }, {\n\t\tsource: source,\n\t\tline_color: util.get_colors(xs.length)\n    }) \n    \n    var tooltips = [\n\t[\"x\"    , \"$x\" ]  , \n\t[\"y\"    , \"$y\" ] \n    ]\n\n    p.add_tools(new Bokeh.HoverTool({tooltips : tooltips , line_policy : \"next\"} ) ) \n\t\n\tvar el = container\n\tif (typeof container == 'string') { \n\t\tel = document.getElementById(container)\n\t}\n\twhile  (el.firstChild) { el.removeChild(el.firstChild)}\n\tBokeh.Plotting.show(p, el)\n    return { plot : p , glyph : glyph , source : source } \n} \n\nfunction create_multi_line_graph(opts) { \n    var { x_len, series_array, title  } = opts \n    var series_len = series_array.length \n    \n    //make xs and ys vector \n    var xs = [] \n    var ys = [] \n    for (var i =0 ;i < series_len ; i++) { \n\txs.push(make_x_series(x_len))\n\tys.push(make_y_series(x_len))\n    } \n    \n    //make data source \n    var source = new Bokeh.ColumnDataSource( {\n\tdata : {xs : xs, ys : ys }\n    })\n    \n    // make the plot and add some tools\n    //var tools = \"pan,crosshair,wheel_zoom,box_zoom,reset,save\";\n\n    // WOW ! -- how lucky to find sizing_mode : stretch_both lmao \n    // https://github.com/bokeh/bokeh/issues/4958\n    \n    var p = Bokeh.Plotting.figure({ title: title,sizing_mode : 'stretch_both' })\n    \n     \n    //add the multiline \n    var glyph = p.multi_line({ field: \"xs\" }, { field: \"ys\" }, {\n\tsource: source,\n\tline_color: util.get_colors(series_len)\n    }) \n    \n    var tooltips = [\n\t[\"x\"    , \"$x\" ]  , \n\t[\"y\"    , \"$y\" ] \n    ]\n\n    p.add_tools(new Bokeh.HoverTool({tooltips : tooltips , line_policy : \"next\"} ) ) \n    \n    //NEXT STEP -- > NEXT STEP -- > NEXT STEP -- > NEXT STEP -- > NEXT STEP -- > \n    //Need to call Bokeh.Plotting.show(p , HTMLelement) \n    return { plot : p , glyph : glyph , source : source } \n\t     \n    \n} \n\n\n\n// Figured out this function by looking at bokeh source code \nvar bokeh_multi_stream = function(ds, x, ys) { \n    var data = ds.data \n    var xss = data.xs\n    var yss = data.ys \n    // make modifications \n\n    for(var i=0;i<yss.length;i++) {\n\t\n\t//NOTE* if one of the y values is false (or undefined) , then the assumption is that \n\t//the series at that index should NOT BE updated \n\t//Sensors in rosegait return false when they wish NOT to be updated \n\t\n\tif (ys[i]) {\n\t    // -  \n\t    xss[i].push(x)\n\t    xss[i].shift()\n\n\t    // -  \n\t    yss[i].push(ys[i])\n\t    yss[i].shift()\n\t    \n\t} \n    }\n    // re assign the data \n    data.xs = xss \n    data.ys = yss \n    ds.setv('data', data, {\n        silent: true\n    });\n    \n    return ds.trigger('stream');\n}\n\n// < -- START CLASS DEFINITIONS -- START CLASS DEFINITIONS -- START CLASS DEFINITIONS -- > \n\n/* \n * A bokeh real time, multi line graph \n *  \n */\nclass Graph { \n    constructor(opts) { \n\tvar {series_vector, title } = opts \n\tthis.parent = null \n\tthis.series_vector = series_vector \n\n\t\n\tvar multi_opts = { x_len : params.global_x_len , \n\t\t\t   title : title ,\n\t\t\t   series_array : series_vector } \n\t\n\tvar  {plot , glyph , source} = create_multi_line_graph(multi_opts) \n\t\n\tvar color = \"#e5efff\" // \"white\" //\"#003559\" //\"#B9D6F2\"\n\tvar alpha = 0.2 \n\tplot.background_fill_color = color\n\tplot.background_fill_alpha = alpha\n\n\tplot.border_fill_color = color\n\tplot.border_fill_alpha = alpha\n\n\tthis.multi_line_graph = plot \n\tthis.source = source \n\tthis.glyph  = glyph \n\t\n    } \n    \n    get_data_source() { \n\treturn this.source \n    } \n    \n    render_into_element(el) { \n\t//el.innerHTML = 'waiting'\n\t//this.parent = el \n\tBokeh.Plotting.show(this.multi_line_graph, el) \n    } \n    \n}\n\n\nexport default class ui { \n    \n    /* \n     * \n     * @param {HTMLElement} parent - The DOM to render the UI into \n     */ \n    constructor(parent) { \n\tthis.graphs = {} \n\tthis.parent = parent \n\tthis.last_series_buffer = {} // holds the previous update sent to graph \n    } \n\n    /* \n     * Add graph to the ui \n     * @param {String} id - graph id \n     * @param {Vector} series_vector - Ids for series which will be graphed on this graph \n     */\n    add_graph(id, series_vector) { \n\tvar graph = new Graph( {series_vector : series_vector, \n\t\t\t\ttitle  : id + \": \" + series_vector.join(\", \")} )   \n\t\t\t       \n\tthis.graphs[id] = graph \n    } \n    \n    /* \n     *\n     * After all graphs have been added, init is called to actually display the graphs \n     *\n     */\n    init(container) { \n\t// logic for displaying all of the added graphs \n\t// should make a panel view of sorts and initialize with empty values \n\tvar graph_array = util.dict_2_vec(this.graphs) \t\n\tthis.graph_array = graph_array  \n\t\n\t// for now will put two graphs side by side \n\tvar n_cols = 2 \n\tvar n_rows = Math.ceil(Object.keys(this.graphs).length/2) \n\t\n\t// some hax  \n\tif (graph_array.length == 1 ) { \n\t    n_cols = n_rows = 1 \n\t} \n\t\n\tutil.bug(\"n_row\" , n_rows) \n\t\n\t// make a grid of divs \n\tvar app_el = util.make_div_array(n_rows,n_cols,\"rgui\",function(r,c,el) { \n\t    //get the graph index\n\t    var index = util.id_from_loc(r,c,n_cols)\n\t    // debug - console.log( [index, graph_array] )\n\t    \n\t    if (index < graph_array.length ) { \n\t\t//get the graph info using destructuring \n\t\tvar [id , graph] = graph_array[index] \n\t\tgraph.render_into_element(el) \n\t    } else { \n\t\t\n\t\treturn \"\" \n\t\t\n\t    }\n\t    \n\t})\n\t\n\t//here we will resolve the container \n\tif ( typeof container == 'string' )  { \n\t    container = document.getElementById(container) \n\t}  // if not for now assume it is the element \n\t\n\t//render the \n\tapp_render(container,app_el)\n\n    } \n\n    /* \n     * Streams data to a particular graph defined by graph_id. \n     * @param {Number} x - The x coordinate for new data \n     * @param {Vector} ys - New y points to add. These should correspond to and be in the same order as the series_vector assoiated with the same graph id\n     */\n    stream_to_graph(id , x , ys ) { \n\tbokeh_multi_stream(this.graphs[id].get_data_source(), x , ys ) \n    }\n    \n    /* \n     * Main data handler. \n     * @param {Object} series_buffer - Dictionary with all the series values for updating\n     */\n    handle_sensor_buffer(x,series_buffer) { \n\t\n\t\n\t//1) loop through the available graphs\n\tfor (var graph in this.graphs ) { \n\t    var series, ys , i , val \n\t    //2) get the series_vector for that graph \n\t    series = this.graphs[graph].series_vector \n\t    //3) look up the values for each series in the sensor_gui_buffer\n\t    ys = Array(series.length).fill(0)\n\t    for (i = 0 ; i < series.length ; i++ ) { \n\t\t//get the value of the series \n\t\tval =  series_buffer[ series[i] ]  \n\t\t\n\t\t//if it is false we pass it anyways (graph will handle it) \n\t\tys[i] = val \n\t    }\n\t    //update the graph \n\t    \n\t    bokeh_multi_stream(this.graphs[graph].get_data_source(), x , ys )\n\n\t    \n\t}\n\n    }\n\t\n\t\n\tstatic multi_line_graph(container, opts) { \n\t\tcreate_static_multi_line_graph(container, opts) \n\t}\n    \n    \n    \n}\n\n\n\n\nvar app_el =  null \n\nvar app_clear = function() { \n    while (app_el.firstChild) {\n\tapp_el.removeChild(app_el.firstChild)  \n    }   \n}\n\nvar app_render = function(container,el) { \n    if (app_el) { \n\tapp_clear() \n    } else { \n\tcontainer.appendChild(el)\n\tapp_el = container\n    }\n}\n","//Wed Oct  3 09:42:59 PDT 2018\n// I remembered my development mantra - be patient. simplify. Refactor when necessary \n\nimport {makeLogger} from \"./logger.js\"\nimport ui from \"./ui.js\"\nimport {util} from \"../module_resources/utils.js\"\n\n/**\n * \n * \n */\n\nexport default class state_machine {\n\n    /**\n     * \n     * \n     */ \n    constructor(opts) { \n\tvar {buffer_size, gui_mode, debug_mode, init} = opts\n\tthis.log = makeLogger(\"SM\") \n\tthis.buffer_size = buffer_size  || 200 \n\tthis.sensor_buffer_size = buffer_size \n\tthis.buffer = Array(buffer_size).fill(default_data_obj)\n\tthis.sensors = {} \n\tthis.transitioners = {} \n\tthis.transitioner_groups = {} \n\tthis.STATE  = init || {} \n\tthis.gui_mode = gui_mode \n\tthis.debug_mode = debug_mode || false \n\tif (gui_mode) { \n\t    //create the sensor_gui buffer \n\t    this.sensors_gui_buffer = {}\n\t    \n\t    this.ui_mapping = null\n\t    \n\t    //also create a ui object  \n\t    this.ui = new ui(null) \n\t} \n    } \n    \n    \n    /** \n     * Initializes the state machine\n     * @param {Object} state - the initial state for the state machine \n     */\n    initialize(state) { \n\tthis.STATE = state \n    } \n\n\n    /** \n     * Updates buffer with a data object. Uses js function `.shift()` to cycle array. \n     * @param {Object} obj - Data object to consume \n     */\n    update_buffer_with_data_object(obj) { \n\tthis.buffer.push(obj) \n\tthis.buffer.shift() \n    } \n    \n    /*\n     * Computes the order that sensors will be evaluated in \n     */\n    set_sensor_order() { \n\tvar compare = function(x,y) { \n\t    var l1 = x[1].level\n\t    var l2 = y[1].level\n\t    //console.log( [l1, l2] ) \n\t    if (l1 > l2 ) {   //index 2 is the level ! \n\t\treturn 1\n\t    } else  { \n\t\treturn -1\n\t    } \n\t}\n\tthis.sensor_order = util.dict_2_vec(this.sensors).sort(compare).map(e=>e[0])\n    }\n    \n    \n    /** \n     * Adds a sensor to the state machine. \n     * @param {Object} opts - contains id, f (function) , level (level 0 is evaluated first , then 1, etc.. ) \n     */\n    add_sensor(opts) { \n\tvar id,f,l\n\tid = opts.id ; f = opts.f ; l = opts.level \n\t//register the sensor \n\tthis.sensors[id] = {} \n  \t//add the function \n\tthis.sensors[id][\"function\"] = f \n\t//and then allocate a buffer for the sensor values \n\tthis.sensors[id][\"buffer\"] = Array(this.sensor_buffer_size).fill(NaN) \n\t//and then allocate the sensor level, 0 if undefined \n\tthis.sensors[id][\"level\"] = l || 0 \n\t//and create the 'last_skipped' flag (see run sensor for more information) \n\tthis.sensors[id][\"last_skipped\"] = false \n\tif (this.debug_mode) { \n\t    this.log(\"Added sensor: \" + id) \n\t}\n\tthis.set_sensor_order() \n    } \n    \n    /** \n     * \n     * Init gui \n     * @param {String|DOM} container - id or reference for container to render into \n     * @param {Object} ui_mapping - Dictionary where keys are graph ids and vals are vectors of the sensors which could be graphed on that graph. E.g { graph-1 : [\"acc_x\", \"acc_z\" ] , etc} \n     */\n    init_gui(container, ui_mapping) { \n\tthis.ui_mapping = ui_mapping \n\t//loop through the graphs \n\tfor (var graph in this.ui_mapping )  { \n\t    var sensors = this.ui_mapping[graph] \n\t    this.ui.add_graph(graph, sensors)  // initializes a graph \n\t} \n\t\n\t//after all the graphs have been added then we call init \n\tthis.ui.init(container) \n\t\n    } \n\n    \n    /** \n     * Runs the sensor function with the state machine buffer as input \n     * then updates the corresponding sensor's buffer.\n     * @param {String} id - Sensor id to run   \n     */\n    run_sensor(id) { \n\t//get the sensor function\n\tvar f = this.sensors[id][\"function\"]\n\t//run the sensor passing in the sm object\n\tvar val = f(this) \n\t\n\t/*\n\t  sensors \n\t  only append the value if it exists \n\t  this allows the ability for sensors to act simultaneously as data filters \n\t  by introspecting on the data_packet somehow and deciding to reject it from \n\t  their buffer. \n\t \n\t*/\n\t\n\tif (val) { \n\t    //append the new value to the sensors buffer \n\t    this.sensors[id][\"buffer\"].push(val)\n\t    this.sensors[id][\"buffer\"].shift() \n\t    this.sensors[id][\"last_skipped\"] = false \n\t}  else {\n\t    //the sensor rejected a value. In this case, it can be helpful to set a special \n\t    //flag in case there are sensors which derive from this one and also wish to \n\t    //reject \n\t    this.sensors[id][\"last_skipped\"] = true \n\t}\n\t\n\treturn val \n    } \n\n    /** \n     * Utility function for retrieving the last N values of a sensor's buffer\n     * Used to make it easier to write Detectors \n     * @param {String} id - Sensor id \n     * @param {Number} num - The number of values to retrieve from END of buffer \n     */\n    get_sensor_last_N(id,num) { \n\tif (this.sensors[id][\"last_skipped\"]) { \n\t    //we have skipped a value, so will pass that info on \n\t    return false \n\t} else { \n\t    return this.sensors[id][\"buffer\"].slice(this.buffer_size - num) \n\t}\n    }\n\n    /** \n     * Utility function for retrieving the last value of a sensor's buffer\n     * Used to make it easier to write Detectors \n     * @param {String} id - Sensor id \n     */\n    get_sensor_last_1(id) { \n\tif (this.sensors[id][\"last_skipped\"]) { \n\t    //we have skipped a value, so will pass that info on \n\t    return false \n\t} else { \n\t    return util.first(this.get_sensor_last_N(id, 1 ) )\n\t} \n    }\n    \n    /** \n     * Adds a transitioner to the state machine. \n     * @param {String} id - Transitioner id for reference \n     * @param {Object} transitioner - Transitioner implementation (Object with keys [detector, applicator]) The detector and applicator both  accept the state_machine object in its entirety in order to allow easy access to all fields. \n     */\n    add_transitioner(id,transitioner) { \n\t//make sure it has what we want \n\tif (! (transitioner.detector && transitioner.applicator ) ) { \n\t    throw \"Transitioner object does not contain both detector and applicator!\" \n\t} \n\t\n \t//register the transitioner\n\tthis.transitioners[id] = transitioner \n\t\n\t//if it is part of a group we register that too , and by default activate it \n\tif (transitioner.group) { \n\t    this.transitioner_groups[transitioner.group] = true \n\t}\n\t\n\tif (this.debug_mode) { \n\t    this.log(\"Added transitioner: \" + id) \n\t}\n\n    }\n    \n    /** \n     * Runs the transitioner \n     * @param {String} id - Transitioner to run \n     */\n    run_transitioner(id) { \n\t//get the transitioner  \n\tvar transitioner = this.transitioners[id] \n\t\n\t//get the group and group status\n\tvar group = transitioner.group\n\tvar group_status = this.transitioner_groups[group]\n\t\n\t//only run if group is NULL or if it exists and is TRUE \n\tif ( group_status != false ) {\n\t    \n\t    //get the detector and applicator \n\t    var detector = transitioner.detector \n\t    var applicator = transitioner.applicator \n\n\t    \n\t    //the detector and applicator both  accept the state_machine object in its entirety in order to allow easy access to all fields \n\t    //apply the applicator IF the detector returns true  \n\t    if (detector(this)) { \n\t\tif (this.debug_mode) { this.log(\":match: => \" + id) }\n\t\tapplicator(this)  // the applciator will actually mutate the this.STATE object  \n\t\t// deactivate this group if it is part of one\n\t\tif (group_status) { \n\t\t    this.transitioner_groups[group] = false \n\t\t} \n\t    } else { \n\t\tif (this.debug_mode) { this.log(\":fail: => \" + id) }\n\t    }\n\t    \n\t}\n\t\n    } \n    \n    \n    \n    /** \n     * Run all sensors. Will sort them by the sensor level \n     */\n    run_sensors() { \n\tfor (var i =0 ; i < this.sensor_order.length; i++ ) { \n\n\t    var sensor_id = this.sensor_order[i]\n\t    var val = this.run_sensor(sensor_id) \n\t    \n\t    if (this.debug_mode) {\n\t\tthis.log(\"Ran sensor: \" + sensor_id + \" with result: \" )\n\t\tthis.log(val)\n\t    }\n\t    \n\t    if (this.gui_mode){ \n\t\tthis.sensors_gui_buffer[sensor_id] = val \n\t    }\n\t}\n\t\n    }\n\n\n    /** \n     * Processes a data object, running one cycle of the state machine. \n     * @param {Object} obj - Data object to process \n     */\n    process_data(obj) { \n\t\n\t//1. update the data buffer  \n\tthis.update_buffer_with_data_object(obj) \n\t\n\t//2. now we need to update all of the sensors \n\tthis.run_sensors() \n\t\n\t//3. now we run all the transitioners (which rely on most up to date Sensor values) \n\tfor (var transitioner_id in this.transitioners ) { \n\t    this.run_transitioner(transitioner_id) \n\t} \n\t\n\t//at this point, this.STATE should be updated , one cycle of the state machine has been completed \n\t//in order to reset, we should return the state of all transition groups \n\tfor (var group in this.transitioner_groups) {\n\t    this.transitioner_groups[group] = true \n\t}\n\t\n\t\n\t// after all this is done we will update the ui \n\t//the sensors_gui_buffer is now full and updated and can be passed to the ui for processing \n\t//pass all the sensor data to the UI for updating \n\tif (this.gui_mode) { \n\t    // also we need to give an X coordinate for the data  \n\t    // for now we will pass the 'time' value of the data obj \n\t    this.ui.handle_sensor_buffer(obj.time,this.sensors_gui_buffer)\n\t}\n\n\t\n    } \n    \n    /** \n     * For debug purposes and profiling. Processes one cycle with a defualt data object\n     */\n    run_debug_cycle() { \n\tthis.process_data(random_data_obj()) \n    } \n    \n\n    \n}\n\n\nvar default_data_obj = { \n    'acc_x' : 0 , \n    'acc_y' : 0 , \n    'acc_z' : 0 , \n    'gyr_x' : 0 , \n    'gyr_y' : 0 , \n    'gyr_z' : 0 , \n    'sample': 0 , \n    'time'  : 0 , \n    'dev'   : \"B\" \n}\n\n\n//for generating random data packets \nvar m = Math.random \nvar count = 0 \nfunction random_data_obj() { \n    return {'acc_x' : m(),\n\t    'acc_y' : m(),\n\t    'acc_z' : m(), \n\t    'gyr_x' : m(), \n\t    'gyr_y' : m(), \n\t    'gyr_z' : m(),\n\t    'sample': count++ , \n\t    'dev'   : \"B\"}\n} \n","// Thu Nov  8 18:17:14 PST 2018\n\nimport {makeLogger} from \"./logger.js\"\nimport {util} from \"../module_resources/utils.js\"\n\n/**\n * Applies a transformation function to a data stream \n *\n * @param {Function} f - The function to use as transform \n */\nexport default class transformer {\n    \n    constructor(f) { \n\tthis.f =  f\n\tthis.log = makeLogger(\"TF\")\n\tthis.default_handler = function(data) { \n\t    this.log(\"No data handler has been defined!\") \n\t} \n\tthis.data_handler = this.default_handler \n    } \n\n    /** \n     * Set the transformer function \n     * @param {Function} func - Function which accepts ONE raw data object and transforms it.\n     */ \n    set_transformer(func) { \n\tthis.f = func \n    } \n    \n    \n    /** \n     * Sets the data_handler attribute\n     * @param {Function} func - Function which accepts ONE raw data object and processes it.\n     */ \n    set_data_handler(func) { \n\tthis.data_handler = func \n    }\n\n    \n    \n    /** \n     * Process a received data object (simply pass it to the data handler) \n     * @param {obj} Data object to receive and transform \n     */ \n    process_data(obj) { \n\tthis.data_handler( this.f(obj) ) \n    }\n\n    \n    \n}\n\n","// Wed Dec  5 08:11:17 PST 2018\n\nimport {makeLogger} from \"./logger.js\"\nimport util from \"../module_resources/utils.js\"\n\n/**\n * Logs whatever it receives\n *\n * @param {Function} f - The function to use as transform \n */\nexport default class logger_node {\n    \n    constructor() { \n\tthis.log = makeLogger(\"LN\")\n\tthis.default_handler = function(data) { \n\t    //do nothing  \n\t    return null \n\t} \n\tthis.data_handler = this.default_handler \n    } \n\n    /** \n     * Sets the data_handler attribute\n     * @param {Function} func - Function which accepts ONE raw data object and processes it.\n     */ \n    set_data_handler(func) { \n\tthis.data_handler = func \n    }\n\n    \n    /** \n     * Process a received data object (simply pass it to the data handler) \n     * @param {obj} Data object to receive and transform \n     */ \n    process_data(obj) { \n\tthis.data_handler( obj ) \n\tconsole.log(obj)\n    }\n\n    \n}\n\n","// Thu Nov  8 18:55:08 PST 2018\n\nimport {makeLogger} from \"./logger.js\"\nimport util from \"../module_resources/utils.js\"\n\n/**\n * Simulator node for testing data streams\n *\n */\nexport default class simulator {\n    \n    constructor(opts) { \n\t\n\tthis.opts  = opts\n\t\n\tthis.log = makeLogger(\"SIM\")\n\tthis.mode = opts.mode \n\tthis.default_handler = function(data) { \n\t    return null \n\t} \n\tthis.data_handler = this.default_handler \n\tthis.stream_interval = null \n\t//this.load_time = (new Date()).getTime() \n    } \n\n    /** \n     * Sets the data_handler attribute\n     * @param {Function} func - Function which accepts ONE raw data object and processes it.\n     */ \n    set_data_handler(func) { \n\tthis.data_handler = func \n    }\n\n    /**\n     * Start streaming simulated data \n     * \n     */\n    start_stream(r) { \n\tthis.stream_interval = setInterval( (this.send_val).bind(this) , r ) \n\t\n    }\n    \n    /** \n     * Stop streaming data \n     */ \n    stop_stream() { \n\tclearInterval(this.stream_interval) \n    }\n    \n    send_val() { \n\tvar val  ; \n\tswitch (this.opts.mode)  { \n\tcase 'sin' : \n\t    val  = Math.sin ( (new Date().getTime()) * this.opts.rate )\n\t    break  ; \n\tcase 'rand' : \n\t    val = (this.opts.multiplier || 1 ) * Math.random() + (this.opts.offset || 0 ) \n\t    break ; \n\tcase 'burst' : \n\t    var burst = ! ( (new Date).getSeconds() % 5  )\n\t    if (true ) { \n\t\tval = {x :  Math.random() + 5, y : Math.random() + 3, z : Math.random() + 20}\n\t    } else { \n\t\tval = {x :  Math.random(), y : Math.random() }\n\t    }\n\t    break ;\n\t} \n\t\n\tthis.data_handler(val) \n    } \n       \n}\n\n","import {makeLogger} from \"./logger.js\"\nimport {util} from \"../module_resources/utils.js\"\n\n\n//scroll DOWN for class definition ! \n// will need to tidy up this file @ some point \n\n// if array of numbers, return the power of array\n// if its a dictionary, then return the reduced version of all its keys\n// if its a number, return the number\n// for now i wont compare strings\n\nvar  power = util.rms \n    \nfunction map_f_on_dict(d,f) {\n    for (var k in d ) {\n\td[k] = f(d[k]) \n    }\n    return d \n}\n\nfunction reduce_val(v) {\n\n    if (typeof v == \"object\") { \n\tif (Array.isArray(v)) {\n\t    // its an array\n\t    return power(v) \n\t    \n\t} else {\n\t    // assume its a dict\n\t    return map_f_on_dict(v, reduce_val) \n\t}\n    } else {\n\n\t// assume its a number\n\treturn v  \n\n    }\n\n}\n\nvar reduce = reduce_val \n\nfunction reduce_dict(obj) {\n    return map_f_on_dict(obj, reduce_val)\n}\n\nlet test_dict = { acc : [ 1,2,3,4,5] , gyr : { foo : 2 , bar : [1,2,3,4,5] } , happy : 1 } \n\n// then, I will need to  Linearize the data object (will assume it is a dict) \n///  loop through keys\n///  if num, push num to ret \n///  if dict, push the recursive result\n\nfunction linearize_dict(obj) {\n    var result = []\n    for (var k in  obj) {\nif (typeof obj[k]  == \"object\" ) {\n   result.push( linearize_dict(obj[k]) ) \n} else {\n   result.push(obj[k])\n} \n    }\n    let flattened =  [].concat.apply([], result)\n    return flattened \n\n} \n\nfunction linearize(obj) {\n    return linearize_dict(obj) \n} \n\n\n// so the workflow for the event_detecting_node is that it does linearize(reduce(packet))\n// and then appends the result to cycling buffer\n\n// so i want the coefficient of variability (STD / MEAN) of ALL indeces to reach some threshold [BT] , at which point baseline is established\n// A baseline snapshot will be taken which includes the mean and std  for all indeces in buffer of B points\n// when a new packet comes in, it is linearized and then transformed to vec of zscores, and DET threshold applied, [DT]\n\n// separately, a history buffer of the actual data objects is kept with size [HB]\n\n// when DT treshold triggered, STATE transitioned to \"recording event\" and contents of HB dumped into  \"current event\"\n// any new packets  are added into \"current event\" , UNTIL [EE] number of packets which do not trigger DT have been received at which\n// point the \"current event\" is optionally added to bank but DEFNITELY FORWARDED to next node as an ARRAY of DATA PACKETS\n\n// At any point -- can trigger the detector_node to re-configure the baseline stds\n\n// optionally there should be a mode for using WRTSM to vizualize the incoming z scores inorder to validate z scoring thresholds \n\n\n\n\n/**\n * Detects and emits deviation \"events\" from streams of arbitraty data objects\n *\n * @param {Object} opts - configuration options\n */\nexport default class event_detector {\n    \n    constructor(opts) { \n\tvar opts = opts || {} \n\tthis.opts =  opts\n\tthis.log = makeLogger(\"ED\")\n\tthis.baseline_data =  null \n\t\n\tthis.state =  { found_baseline : false  } \n\t\t\t\n\t\n\tthis.baseline_buffer_size  = opts.baseline_buffer_size || 10 \n\tthis.history_buffer_size  = opts.baseline_buffer_size || 50\n\tthis.init_baseline_buffer() //will init baseline buffer with size N and fill with value null \n\tthis.init_history_buffer()  \n\t\n\t\n\t\n\tthis.default_handler = function(data) { \n\t    this.log(\"No data handler has been defined!\") \n\t} \n\tthis.data_handler = this.default_handler \n    } \n    \n    \n    process_pre_baseline(obj) { \n\tlet transformed_packet = linearize(reduce(obj))  //transform the packet into linear array \n\tthis.add_to_baseline(transformed_packet)         //add the information to our baseline buffer \n\t\n\t//get stats from the current buffer \n\tlet spd = util.spd_matrix(this.baseline_buffer) \n\t\n\t//for now I really want to vizualize \n\treturn spd\n\t\n    }\n    \n\n    //hmm I just had a realization -- what I actually want is to detect CHANGES in the signal - so it is natural that I use DIFFS ! \n    //better to have a small baseline buffer, after B samples of no change, baseline is established. Thereafter an \n    //\"event\" is initiated when ANY change occurs, and then ends when there have been NUM_TO_FINISH numbers of packets with no change \n\t\n\t\n    \n       \n    /** \n     * Process a received data object\n     * @param {obj} Data object to receive \n     */ \n    process_data(obj) { \n\tif (this.baseline_buffer_full() ) { \n\t    var result\n\t    if (this.state.found_baseline ) { \n\t\tresult = this.process_post_baseline(obj)\n\t    } else { \n\t\tresult = this.process_pre_baseline(obj) \n\t    }\n\t    this.data_handler(result)\n\t} else { \n\t    \n\t    let transformed_packet = linearize(reduce(obj))  //transform the packet into linear array \n\t    this.add_to_baseline(transformed_packet)         //add the information to our baseline buffe\n\t    \n\t}\n    }\n    \n    \n    add_to_baseline(obj) { \n\tutil.cycle_array(this.baseline_buffer, obj) \n    }\n\n    add_to_history(obj) { \n\tutil.cycle_array(this.history_buffer, obj) \n    }\n\n    /**\n     * Init baseline buffer \n     * \n     */\n    init_baseline_buffer() { \n\tthis.baseline_buffer = Array(this.baseline_buffer_size).fill(0)\t\n    }\n    \n    /**\n     * init history buffer \n     * \n     */\n    init_history_buffer() { \n\tthis.history_buffer = Array(this.history_buffer_size).fill(0)\n    }\n    \n    /**\n     * Checks if the baseline buffer is full \n     */\n    baseline_buffer_full() { \n\treturn this.baseline_buffer[0]   //this works because the basline buffer is an array of 0 at init. Only when last value exists b[0] will be true\n    } \n    \n    \n    \n    /** \n     * Sets the data_handler attribute\n     * @param {Function} func - Function which accepts ONE raw data object and processes it.\n     */ \n    set_data_handler(func) { \n\tthis.data_handler = func \n    }\n\n \n\n    \n    \n}\n","// bundles all the modules into one object for easy access \n// Mon Oct 22 22:16:23 PDT 2018\n\nimport web_socket from \"./core_modules/web_socket.js\" \nimport data_storage from \"./core_modules/data_storage.js\" \nimport pipe_manager from \"./core_modules/pipe_manager.js\" \nimport raw_analyzer from \"./core_modules/raw_analyzer.js\" \nimport state_machine from \"./core_modules/state_machine.js\" \nimport transformer from \"./core_modules/transformer.js\" \nimport logger_node from \"./core_modules/logger_node.js\" \nimport simulator from \"./core_modules/simulator.js\" \nimport ui from \"./core_modules/ui.js\" \nimport event_detector from \"./core_modules/event_detector.js\" \n\n\nexport var mods = { web_socket, data_storage , pipe_manager , raw_analyzer, state_machine, ui, transformer, simulator, logger_node, event_detector }\n\n","import {util}     from \"./utils.js\"\n\nvar smu = { sensors : {} , transformers : {}  } \n\nsmu.sensors.field = function(field) { \n    return function(sm) { \n\tlet d = sm.buffer \n\treturn util.last(d)[field] \n    }\n} \n\n\nexport { smu } \n","import {util}     from \"./module_resources/utils.js\"\n\nvar dev = { vars : {} } \n\n\ndev.msg = \"Used for shipping development objects and functions with wrtsm\" \n\nexport { dev } \n","import {mods}  from  \"./module_bundle.js\"\nimport {smu}   from  \"./module_resources/sm_utils.js\" \nimport {dev}   from  \"./dev.js\"\n\n// defines object that will be attached to window \nvar wrtsm = {}  \n\n//give it modules\nwrtsm.mods = mods \nwrtsm.smu  = smu \nwrtsm.dev  = dev\n\n\n\n//add it to window \nwindow.wrtsm = wrtsm \n\n\n//export it for use \nexport { wrtsm } \n\n\n\n","//Fri Oct  5 19:31:23 PDT 2018\n\n// filefor collecting definitions of Sensors and transitioners\n\nimport {logger} from \"../core_modules/logger.js\"\nimport {util}     from \"./utils.js\"\n\nlogger.register(\"sme\") \n\nvar sme = { sensors : { dev_a : {} , dev_b : {} } , \n\t    transitioners : {} }  \n\n\n//extract a specific field from the data objects \n//i.e. [{:acc_x :acc_y... } , ... ] => [ acc_x, acc_x ... ] \nsme.sensors.field = function(field) { \n    return function(d) { \n\td = d.buffer \n\treturn util.last(buffer)[field] \n    }\n} \n\n\n//field diff will take the  diff of a particular field in the data object \nsme.sensors.field_diff = function(field) { \n    return function(d) { \n\td = d.buffer \n\tvar l = d.length \n\treturn d[l-1][field] - d[l-2][field]\n    }\n} \n\n\n\nsme.is_dev_b = function (d) { \n    return d.dev == \"B\" \n} \n\nsme.is_dev_a = function (d) { \n    return d.dev == \"A\" \n} \n\nsme.sensors.dev_b.field = function(field) { \n    //return sme.generic_filter(sme.is_dev_b , d=>d[field] ) \n    return function(d) {\n\tvar buf = d.buffer \n\tvar d = util.last(buf) \n\tif (d.dev == \"B\") { \n\t    return d[field]\n\t} else { \n\t    util.debug(\"filter miss\")\n\t    return false }\n    }\n}\n\nsme.transitioners.test_turn_on  = { \n    \"detector\" : function(state_machine) { \n\treturn !state_machine.STATE.is_on \n\t\n    } , \n    \"applicator\" : function(state_machine) { \n\tstate_machine.STATE.is_on = true \n\tif (state_machine.debug_mode ) { logger.sme(\"TURNED ON\") }\n    },\n    \"group\" : \"switch\" \n}\n\n\nsme.transitioners.test_turn_off  = { \n    \"detector\" : function(state_machine) { \n\treturn state_machine.STATE.is_on \n    } , \n    \"applicator\" : function(state_machine) { \n\tstate_machine.STATE.is_on = false  \n\tif (state_machine.debug_mode ) { logger.sme(\"TURNED OFF\") }\n    } , \n    \"group\" : \"switch\" \n}\n\n\n\n\nexport { sme } \n","1//Fri Oct  5 18:28:58 PDT 2018\n// workflows for RoseGait  \n\nimport util     from \"../module_resources/utils.js\"\nimport {sme}      from \"../module_resources/state_machine_elements.js\"\nimport {wrtsm}  from \"../wrtsm.js\"\nimport {logger} from \"../core_modules/logger.js\"\n\nlogger.register(\"rg\") \n\nvar flow = {} \n\nflow.test_storage_persist = function(name) { \n    //1. create web_socket object \n    ws = new wrtsm.mods.web_socket(\"ws://localhost:1234\") \n\n    //2. create data_storage object \n    ds = new wrtsm.mods.data_storage(name) \n\n    //3. create pipe manager object and connect 1 & 2 \n    pm = new wrtsm.mods.pipe_manager() \n    pm.connect(ws,ds) \n\n    //4. Enable saving on the data_storage object every 5s  \n    ds.start_saving(5) \n\n    //5. connect the websocket (which should automatically start receiving data) \n    ws.connect()\n    \n    //6. Stop streaming after 20s \n    setTimeout(function() { \n\tws.stop_stream() \n\tds.stop_saving() \n\tconsole.log(\"Streaming and saving stopped.\") \n    }, 21*1000)\n    \n} \n\n\nflow.test_storage_replay = function() { \n    //1. create data_storage object & load session \n    ds = new wrtsm.mods.data_storage(\"eugene_walk_rev\") \n    ds.load_session() \n    \n    //2. create raw_analyzer object \n    ra = new wrtsm.mods.raw_analyzer() \n\n    //3. create pipe manager object and connect 1 & 2 \n    pm = new wrtsm.mods.pipe_manager() \n    pm.connect(ds,ra) \n\n    //4. start the stream ! \n    ds.start_stream() \n    \n    return [ds,ra ] \n\n} \n\nflow.test_state_machine = function(n) {\n    logger.rg(\"Creating state machine with size: \" + n) \n    var sm = new wrtsm.mods.state_machine({buffer_size : n, gui_mode:  false } ) \n    sm.initialize({\"is_on\" : false }) \n    \n    logger.rg(\"Adding sensors\") \n    sm.add_sensor({id:\"acc_x\" , f:sme.sensors.field(\"acc_x\"), graph : \"g1\"})\n    sm.add_sensor({id: \"acc_x_diff\" ,f: sme.sensors.field_diff(\"acc_x\"), graph : \"g1\"})\n    \n    logger.rg(\"Adding transitioners\") \n    sm.add_transitioner(\"test_turn_on\", sme.transitioners.test_turn_on ) \n    sm.add_transitioner(\"test_turn_off\", sme.transitioners.test_turn_off ) \n    \n    // ok so at this point everything should be initialized and we should be able \n    // to start profiling and inspecing the state machine \n    logger.rg(\"Returning sm\") \n    return sm \n    \n    \n    \n} \n\n\nflow.test_state_machine_gui = function(d) {\n    var n = 200 \n    logger.rg(\"Creating state machine with size: \" + n) \n    var sm = new wrtsm.mods.state_machine({buffer_size : n, gui_mode:  true } ) \n    sm.initialize({\"is_on\" : false }) \n    \n    logger.rg(\"Adding sensors\") \n    sm.add_sensor({id:\"acc_x\" , f:sme.sensors.field(\"acc_x\"), graph : \"g1\"})\n    sm.add_sensor({id: \"acc_x_diff\" ,f: sme.sensors.field_diff(\"acc_x\"), graph : \"g1\"})\n    \n    logger.rg(\"Adding transitioners\") \n    sm.add_transitioner(\"test_turn_on\", sme.transitioners.test_turn_on ) \n    sm.add_transitioner(\"test_turn_off\", sme.transitioners.test_turn_off ) \n    \n    // ok so at this point everything should be initialized and we should be able \n    // to start profiling and inspecing the state machine \n\n    sm.init_gui(\"wrtsm\",d) \n\n    logger.rg(\"Returning sm\") \n    return sm \n    \n    \n    \n} \n\nflow.playback_gui = function(d) {\n    var n = 200 \n    logger.rg(\"Creating state machine with size: \" + n) \n    var sm = new wrtsm.mods.state_machine({buffer_size :n, gui_mode:  true, debug_mode : false }) \n    \n    logger.rg(\"Adding sensors\") \n    sm.add_sensor({id:\"dev_b_gyr_z\" , f:sme.sensors.dev_b.field(\"gyr_z\") })\n    //sm.add_sensor({id: \"acc_x_diff\" ,f: sme.sensors.field_diff(\"acc_x\")})\n    sm.add_sensor({id: \"acc_y\" ,f: sme.sensors.field(\"acc_y\")})\n    sm.add_sensor({id: \"gyr_z\" ,f: sme.sensors.field(\"gyr_z\")})\n\n    logger.rg(\"Adding transitioners\") \n    sm.add_transitioner(\"test_turn_on\", sme.transitioners.test_turn_on )\n    sm.add_transitioner(\"test_turn_off\", sme.transitioners.test_turn_off )\n\n\n    // ok so at this point state machine should be initialized \n    logger.rg(\"Calling sm.init_gui\") \n    sm.init_gui(\"wrtsm\", d) \n    \n    //will load the file from storage \n    var ds = new wrtsm.mods.data_storage(\"eugene_walk_rev\") \n    ds.load_session() \n    \n    //and then create a pipe manager to connect the stored data file to the state machine \n    var pm = new wrtsm.mods.pipe_manager() \n    pm.connect(ds,sm) \n    \n    //return them and can call ds.start_stream() for continuous simulation \n    //OR ds.stream_single_packet() to step one sample\n    return [ds, pm, sm ] \n\n} \n\n\nflow.graph_dances = function() { \n    var d = { g1 : [\"acc_x\", \"acc_y\"] } //, \"gyr_z\"] }  \n    //[sm,d] = test_state_machine_gui({ g1 : [\"acc_x\"] , g2 : [ \"acc_y\"] }) \n    var sm = flow.test_state_machine_gui(d) \n    //[sm,d] = test_state_machine_gui({ g1 : [\"acc_x\",  \"acc_y\"] , g2 : [  \"gyr_z\"] })\n    //util.app_render(test_div_array(1,2)) \n\n\n    var line_dance = function() { \n\tsm.ui.handle_sensor_buffer(200+speed*counter, {acc_x : 0.5*counter , acc_y : -0.5*counter})\n    }\n\n    var sine_rate = 2/100\n    var sine_rate_2 = 5/100\n    var sine_rate_3 = 7/100\n    var sine_dance_0 = function() { \n\tsm.ui.handle_sensor_buffer(200+speed*counter, {acc_x : Math.sin(sine_rate*counter) , acc_y : -Math.sin(sine_rate_2*counter)})\n    }\n\n    var sine_dance_1 = function() { \n\tsm.ui.handle_sensor_buffer(200+speed*counter, {acc_x : Math.sin(sine_rate*counter) , acc_y : -Math.sin(sine_rate_2*counter) , gyr_z : Math.sin(sine_rate_3*counter)})\n    }\n\n\n    var speed = 20\n    var counter = 0 \n    var a = setInterval( (function() { \n\tsine_dance_0()\n\tcounter++ \n    }), 50 ) \n    var stop = function() { \n\tclearInterval(a) \n    }\n\n    return [sm  , a,  stop ] \n\n}\n    \n\n\n// [0,1,2,3,4] \n//  [1,1,1,1] \n\nflow.graph_sm_test = function() { \n    //now we will loop and do the perf \n    var num = 200\n    var interval = 1\n    var start = 2\n    var sizes = Array(num).fill(0) \n    var results = Array(num).fill(0) \n    for (var i = 0; i < num ; i ++ ) { \n\tvar size = start + i * interval \n\tsizes[i] = size \n\t//create the sm \n\tvar sm = test_state_machine(size) \n\t\n\t//define the perf function \n\tvar test_cycle = ( function() { \n\t    sm.run_debug_cycle() \n\t}).bind(sm)\n\t\n\t//now we perf it \n\tresults[i] = util.perf(test_cycle)\n    } \n    \n    //at this point results should be full . \n    logger.rg(\"Graphing results... \") \n    bar_graph(\"Perf\" , \"size\", \"time\" , sizes, results ) \n    logger.rg(\"hmm.. ?\")\n}\n    \n    \n// want to be able to play back data \n/* \nA brief historical aside: \nat first I recorded the data withuot converting the Strings inside the objects to numbers \nTo solve, I loaded the recorded file, then mapped the conversion accross the loaded buffer \nThen I made a new wrtsm.mods.data storage object with _rev extension, and connecnted d1 to d2. \nThen I started d2.save and d1.stream \nvoila \n */ \n\nflow.EW = function() { \n    d = new wrtsm.mods.data_storage(\"eugene_walk_rev\") \n    d.load_session() \n    \n    //at this pt data is accesible in d.loaded_sesssion \n    return d \n} \n    \n\n\n\nexport {flow} \n\n","\nvar sounds = {} \nsounds.ctx = new AudioContext()\n\nsounds.osc = function(type , freq, gainVal){\n    var osc, gain \n    \n    osc = sounds.ctx.createOscillator()\n    osc.frequency.value = freq\n    gain = sounds.ctx.createGain()\n    osc.type = type\n    gain.connect(sounds.ctx.destination)\n    gain.gain.value = gainVal\n    osc.connect(gain)\n    osc.start()\n    return osc \n} \n\n\n\n\n\n\n\nvar beep_time = 150\nvar beep_dic = { 0 : 300 , 1 : 350 , 2 : 400 , 3 : 450 , 4 : 500 }\nfunction beep(n) { \n    var f = beep_dic[n]\n    var s = sounds.osc(\"sine\" , f , 1 ) \n    setTimeout( function() {s.stop() } , beep_time)\n}\n\n\nexport { beep } \n\n\n","export function load_script(url,cb){\n\n    var script = document.createElement(\"script\")\n    script.type = \"text/javascript\";\n\n    if (script.readyState){  //IE \n        script.onreadystatechange = function(){\n            if (script.readyState == \"loaded\" ||\n                    script.readyState == \"complete\"){\n                script.onreadystatechange = null;\n\t\tif (cb) { \n                    cb();\n\t\t}\n            }\n        };\n    } else {  //Others\n        script.onload = function(){\n\t    if (cb) {\n\t\tcb();\n\t    }\n        };\n    }\n\n    script.src = url;\n    document.getElementsByTagName(\"head\")[0].appendChild(script);\n}\n\n\nexport function load_css(url,cb) { \n    \n    var link = document.createElement(\"link\")\n    link.type = \"text/css\";\n    link.rel = 'stylesheet';\n\n\n    if (link.readyState){  //IE \n        link.onreadystatechange = function(){\n            if (link.readyState == \"loaded\" ||\n                    link.readyState == \"complete\"){\n                link.onreadystatechange = null;\n\t\tif (cb) { \n                    cb();\n\t\t}\n            }\n        };\n    } else {  //Others\n        link.onload = function(){\n\t    if (cb) {\n\t\tcb();\n\t    }\n        };\n    }\n\n    link.href = url;\n    document.getElementsByTagName(\"head\")[0].appendChild(link);\n}\n    \n","//The main program 1\n\n/* - - - - - - - */ \nconsole.log(\":: wrtsm initializing ::\")\n\n\nimport {wrtsm}  from  \"./wrtsm.js\"  //import global wrtsm object \nimport {flow}   from  \"./scripts/rose_gait_workflows.js\" \nimport {util}   from  \"./module_resources/utils.js\"\nimport {beep}   from  \"./module_resources/sounds.js\"\nimport {logger} from  \"./core_modules/logger.js\"\nimport {load_script, load_css} from  \"./module_resources/script_loader.js\"\n\n// set debug \nutil.set_debug(false)\n\n//make logger \nlogger.register(\"wrtsm\")\n\n/* additions to global context */ \nwrtsm.flow = flow \nwrtsm.util = util \nwrtsm.beep = beep \n\n\n\n// HANDLE BOKEH LOADING (load the content from cdn if Bokeh is not defined in the window) ======================================== > \nif (window.Bokeh) { \n    logger.wrtsm(\"Bokeh was detected already. If you experience any errors, please make sure that the following resources are included in your html for proper functionality:\")\n    console.log(\"<link rel=\\\"stylesheet\\\" href=\\\"https://cdn.pydata.org/bokeh/release/bokeh-0.12.5.min.css\\\" type=\\\"text/css\\\" />\")\n    console.log(\"<script type=\\\"text/javascript\\\" src=\\\"https://cdn.pydata.org/bokeh/release/bokeh-0.12.5.js\\\"></script>\")\n    console.log(\"<script type=\\\"text/javascript\\\" src=\\\"https://cdn.pydata.org/bokeh/release/bokeh-api-0.12.5.min.js\\\"></script>\")\n} else { \n    //will dynamically load the above resources: \n    //define callback \n    function load_api() { \n\tlogger.wrtsm(\"bokeh-0.12.5.js loaded\")\n\twindow.ls = load_script \n\tload_script(\"https://cdn.pydata.org/bokeh/release/bokeh-api-0.12.5.min.js\" , function () { \n\t    console.log(\"[wrtsm]:: bokeh-api-0.12.5.min.js loaded\" )\n\t    //we will bubble an event that says wrtsm is ready ! \n\t    var event = new Event('wrtsm_ready');\n\t    window.dispatchEvent(event);\n\t} ) \n    } \n    logger.wrtsm(\"Loading Bokeh functionality:\") \n    load_script(\"https://cdn.pydata.org/bokeh/release/bokeh-0.12.5.js\" , load_api ) \n    load_css(\"https://cdn.pydata.org/bokeh/release/bokeh-0.12.5.min.css\" , function () { console.log(\"[wrtsm]:: bokeh-0.12.5.min.css loaded\" ) } ) \n} \n// HANDLE BOKEH LOADING (load the content from cdn if Bokeh is not defined in the window) ======================================== > \n\nwrtsm.load_time  = (new Date()).getTime() \n\n\n\n\n//var d = {\"misc\" : [\"dev_b_gyr_z\"] } \n\n//setTimeout( function() { window.d = flow.playback_gui(d) ; window.d[0].start_stream()  } , 1000)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"]}