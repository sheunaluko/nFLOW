{"id":"J97u","dependencies":[{"name":"/Users/oluwa/dev/webrt_state_machine/package.json","includedInParent":true,"mtime":1543982915847},{"name":"./logger.js","loc":{"line":3,"column":25},"parent":"/Users/oluwa/dev/webrt_state_machine/src/core_modules/web_socket.js","resolved":"/Users/oluwa/dev/webrt_state_machine/src/core_modules/logger.js"},{"name":"../module_resources/utils.js","loc":{"line":4,"column":19},"parent":"/Users/oluwa/dev/webrt_state_machine/src/core_modules/web_socket.js","resolved":"/Users/oluwa/dev/webrt_state_machine/src/module_resources/utils.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.default=void 0;var e=require(\"./logger.js\"),t=require(\"../module_resources/utils.js\");function n(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}function s(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,\"value\"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function a(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}var i=function(){function s(t){n(this,s),this.url=t,this.connection=null,this.log=(0,e.makeLogger)(\"WS\"),this.default_handler=function(e){this.log(\"No data handler has been defined!\")},this.data_handler=this.default_handler}return a(s,[{key:\"connect\",value:function(){var e=new WebSocket(this.url);e.addEventListener(\"open\",function(e){this.log(\"Connection to \"+this.url+\" successful. Registering client with server.\"),this.send_json({type:\"register\",data:\"client\"}),this.send_json({type:\"control\",data:\"start\"})}.bind(this)),e.addEventListener(\"message\",function(e){this.data_handler(t.util.dict_vals_2_num(JSON.parse(e.data)))}.bind(this)),this.connection=e}},{key:\"start_stream\",value:function(){this.send_json({type:\"control\",data:\"start\"})}},{key:\"stop_stream\",value:function(){this.send_json({type:\"control\",data:\"stop\"})}},{key:\"set_data_handler\",value:function(e){this.data_handler=e}},{key:\"send_json\",value:function(e){this.connection.send(JSON.stringify(e))}}]),s}();exports.default=i;","map":{"mappings":[{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":0}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":13}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":20}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":35}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":43}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":56}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":57}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":64}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":68}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":76}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":89}},{"source":"core_modules/web_socket.js","original":{"line":3,"column":0},"generated":{"line":1,"column":91}},{"source":"core_modules/web_socket.js","original":{"line":3,"column":0},"generated":{"line":1,"column":95}},{"source":"core_modules/web_socket.js","original":{"line":3,"column":0},"generated":{"line":1,"column":97}},{"source":"core_modules/web_socket.js","original":{"line":3,"column":0},"generated":{"line":1,"column":105}},{"source":"core_modules/web_socket.js","original":{"line":4,"column":0},"generated":{"line":1,"column":120}},{"source":"core_modules/web_socket.js","original":{"line":4,"column":0},"generated":{"line":1,"column":122}},{"source":"core_modules/web_socket.js","original":{"line":4,"column":0},"generated":{"line":1,"column":130}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":162}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":171}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":173}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":175}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":178}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":183}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":196}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":199}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":205}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":209}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":219}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":256}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":265}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":267}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":269}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":272}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":276}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":280}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":282}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":284}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":286}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":288}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":295}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":299}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":300}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":304}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":306}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":308}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":311}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":313}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":324}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":326}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":339}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":341}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":343}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":357}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":359}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":369}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":373}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":375}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":385}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":388}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":395}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":410}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":412}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":414}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":418}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":422}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":431}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":433}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":435}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":437}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":440}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":447}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":450}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":452}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":454}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":464}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":467}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":470}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":472}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":474}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":477}},{"source":"core_modules/web_socket.js","name":"web_socket","original":{"line":11,"column":21},"generated":{"line":1,"column":479}},{"source":"core_modules/web_socket.js","name":"web_socket","original":{"line":11,"column":21},"generated":{"line":1,"column":483}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":485}},{"source":"core_modules/web_socket.js","name":"url","original":{"line":13,"column":16},"generated":{"line":1,"column":496}},{"source":"core_modules/web_socket.js","name":"url","original":{"line":13,"column":16},"generated":{"line":1,"column":505}},{"source":"core_modules/web_socket.js","name":"url","original":{"line":13,"column":16},"generated":{"line":1,"column":507}},{"source":"core_modules/web_socket.js","original":{"line":13,"column":21},"generated":{"line":1,"column":510}},{"source":"core_modules/web_socket.js","original":{"line":13,"column":21},"generated":{"line":1,"column":512}},{"source":"core_modules/web_socket.js","original":{"line":13,"column":21},"generated":{"line":1,"column":517}},{"source":"core_modules/web_socket.js","name":"url","original":{"line":14,"column":6},"generated":{"line":1,"column":520}},{"source":"core_modules/web_socket.js","name":"url","original":{"line":14,"column":6},"generated":{"line":1,"column":525}},{"source":"core_modules/web_socket.js","name":"url","original":{"line":14,"column":12},"generated":{"line":1,"column":529}},{"source":"core_modules/web_socket.js","name":"connection","original":{"line":15,"column":6},"generated":{"line":1,"column":531}},{"source":"core_modules/web_socket.js","name":"connection","original":{"line":15,"column":6},"generated":{"line":1,"column":536}},{"source":"core_modules/web_socket.js","original":{"line":15,"column":19},"generated":{"line":1,"column":547}},{"source":"core_modules/web_socket.js","name":"log","original":{"line":16,"column":6},"generated":{"line":1,"column":552}},{"source":"core_modules/web_socket.js","name":"log","original":{"line":16,"column":6},"generated":{"line":1,"column":557}},{"source":"core_modules/web_socket.js","original":{"line":16,"column":12},"generated":{"line":1,"column":562}},{"source":"core_modules/web_socket.js","original":{"line":16,"column":23},"generated":{"line":1,"column":564}},{"source":"core_modules/web_socket.js","original":{"line":16,"column":23},"generated":{"line":1,"column":566}},{"source":"core_modules/web_socket.js","original":{"line":16,"column":23},"generated":{"line":1,"column":578}},{"source":"core_modules/web_socket.js","name":"default_handler","original":{"line":17,"column":6},"generated":{"line":1,"column":584}},{"source":"core_modules/web_socket.js","name":"default_handler","original":{"line":17,"column":6},"generated":{"line":1,"column":589}},{"source":"core_modules/web_socket.js","original":{"line":17,"column":24},"generated":{"line":1,"column":605}},{"source":"core_modules/web_socket.js","name":"data","original":{"line":17,"column":33},"generated":{"line":1,"column":614}},{"source":"core_modules/web_socket.js","name":"log","original":{"line":18,"column":10},"generated":{"line":1,"column":617}},{"source":"core_modules/web_socket.js","name":"log","original":{"line":18,"column":10},"generated":{"line":1,"column":622}},{"source":"core_modules/web_socket.js","original":{"line":18,"column":14},"generated":{"line":1,"column":626}},{"source":"core_modules/web_socket.js","name":"data_handler","original":{"line":20,"column":6},"generated":{"line":1,"column":664}},{"source":"core_modules/web_socket.js","name":"data_handler","original":{"line":20,"column":6},"generated":{"line":1,"column":669}},{"source":"core_modules/web_socket.js","original":{"line":20,"column":21},"generated":{"line":1,"column":682}},{"source":"core_modules/web_socket.js","name":"default_handler","original":{"line":20,"column":26},"generated":{"line":1,"column":687}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":703}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":710}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":712}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":714}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":715}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":716}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":720}},{"source":"core_modules/web_socket.js","original":{"line":27,"column":14},"generated":{"line":1,"column":730}},{"source":"core_modules/web_socket.js","original":{"line":27,"column":14},"generated":{"line":1,"column":736}},{"source":"core_modules/web_socket.js","name":"conn","original":{"line":28,"column":5},"generated":{"line":1,"column":747}},{"source":"core_modules/web_socket.js","name":"conn","original":{"line":28,"column":5},"generated":{"line":1,"column":751}},{"source":"core_modules/web_socket.js","original":{"line":28,"column":13},"generated":{"line":1,"column":753}},{"source":"core_modules/web_socket.js","name":"WebSocket","original":{"line":28,"column":17},"generated":{"line":1,"column":757}},{"source":"core_modules/web_socket.js","original":{"line":28,"column":27},"generated":{"line":1,"column":767}},{"source":"core_modules/web_socket.js","name":"url","original":{"line":28,"column":32},"generated":{"line":1,"column":772}},{"source":"core_modules/web_socket.js","name":"conn","original":{"line":30,"column":1},"generated":{"line":1,"column":777}},{"source":"core_modules/web_socket.js","name":"addEventListener","original":{"line":30,"column":6},"generated":{"line":1,"column":779}},{"source":"core_modules/web_socket.js","original":{"line":30,"column":23},"generated":{"line":1,"column":796}},{"source":"core_modules/web_socket.js","original":{"line":30,"column":32},"generated":{"line":1,"column":803}},{"source":"core_modules/web_socket.js","name":"event","original":{"line":30,"column":42},"generated":{"line":1,"column":812}},{"source":"core_modules/web_socket.js","name":"log","original":{"line":31,"column":10},"generated":{"line":1,"column":815}},{"source":"core_modules/web_socket.js","name":"log","original":{"line":31,"column":10},"generated":{"line":1,"column":820}},{"source":"core_modules/web_socket.js","original":{"line":31,"column":14},"generated":{"line":1,"column":824}},{"source":"core_modules/web_socket.js","original":{"line":31,"column":33},"generated":{"line":1,"column":841}},{"source":"core_modules/web_socket.js","name":"url","original":{"line":31,"column":38},"generated":{"line":1,"column":846}},{"source":"core_modules/web_socket.js","original":{"line":31,"column":44},"generated":{"line":1,"column":850}},{"source":"core_modules/web_socket.js","name":"send_json","original":{"line":32,"column":10},"generated":{"line":1,"column":898}},{"source":"core_modules/web_socket.js","name":"send_json","original":{"line":32,"column":10},"generated":{"line":1,"column":903}},{"source":"core_modules/web_socket.js","original":{"line":32,"column":20},"generated":{"line":1,"column":913}},{"source":"core_modules/web_socket.js","name":"type","original":{"line":32,"column":21},"generated":{"line":1,"column":914}},{"source":"core_modules/web_socket.js","original":{"line":32,"column":27},"generated":{"line":1,"column":919}},{"source":"core_modules/web_socket.js","name":"data","original":{"line":32,"column":40},"generated":{"line":1,"column":930}},{"source":"core_modules/web_socket.js","original":{"line":32,"column":47},"generated":{"line":1,"column":935}},{"source":"core_modules/web_socket.js","name":"send_json","original":{"line":33,"column":10},"generated":{"line":1,"column":946}},{"source":"core_modules/web_socket.js","name":"send_json","original":{"line":33,"column":10},"generated":{"line":1,"column":951}},{"source":"core_modules/web_socket.js","original":{"line":33,"column":20},"generated":{"line":1,"column":961}},{"source":"core_modules/web_socket.js","name":"type","original":{"line":33,"column":21},"generated":{"line":1,"column":962}},{"source":"core_modules/web_socket.js","original":{"line":33,"column":27},"generated":{"line":1,"column":967}},{"source":"core_modules/web_socket.js","name":"data","original":{"line":33,"column":40},"generated":{"line":1,"column":977}},{"source":"core_modules/web_socket.js","original":{"line":33,"column":47},"generated":{"line":1,"column":982}},{"source":"core_modules/web_socket.js","name":"bind","original":{"line":34,"column":4},"generated":{"line":1,"column":993}},{"source":"core_modules/web_socket.js","original":{"line":34,"column":9},"generated":{"line":1,"column":998}},{"source":"core_modules/web_socket.js","name":"conn","original":{"line":38,"column":1},"generated":{"line":1,"column":1005}},{"source":"core_modules/web_socket.js","name":"addEventListener","original":{"line":38,"column":6},"generated":{"line":1,"column":1007}},{"source":"core_modules/web_socket.js","original":{"line":38,"column":23},"generated":{"line":1,"column":1024}},{"source":"core_modules/web_socket.js","original":{"line":38,"column":35},"generated":{"line":1,"column":1034}},{"source":"core_modules/web_socket.js","name":"event","original":{"line":38,"column":45},"generated":{"line":1,"column":1043}},{"source":"core_modules/web_socket.js","name":"data_handler","original":{"line":40,"column":10},"generated":{"line":1,"column":1046}},{"source":"core_modules/web_socket.js","name":"data_handler","original":{"line":40,"column":10},"generated":{"line":1,"column":1051}},{"source":"core_modules/web_socket.js","name":"util","original":{"line":40,"column":23},"generated":{"line":1,"column":1064}},{"source":"core_modules/web_socket.js","name":"dict_vals_2_num","original":{"line":40,"column":28},"generated":{"line":1,"column":1066}},{"source":"core_modules/web_socket.js","name":"dict_vals_2_num","original":{"line":40,"column":28},"generated":{"line":1,"column":1071}},{"source":"core_modules/web_socket.js","name":"JSON","original":{"line":40,"column":44},"generated":{"line":1,"column":1087}},{"source":"core_modules/web_socket.js","name":"parse","original":{"line":40,"column":49},"generated":{"line":1,"column":1092}},{"source":"core_modules/web_socket.js","name":"event","original":{"line":40,"column":55},"generated":{"line":1,"column":1098}},{"source":"core_modules/web_socket.js","name":"data","original":{"line":40,"column":61},"generated":{"line":1,"column":1100}},{"source":"core_modules/web_socket.js","name":"bind","original":{"line":41,"column":4},"generated":{"line":1,"column":1109}},{"source":"core_modules/web_socket.js","original":{"line":41,"column":9},"generated":{"line":1,"column":1114}},{"source":"core_modules/web_socket.js","name":"connection","original":{"line":43,"column":6},"generated":{"line":1,"column":1121}},{"source":"core_modules/web_socket.js","name":"connection","original":{"line":43,"column":6},"generated":{"line":1,"column":1126}},{"source":"core_modules/web_socket.js","name":"conn","original":{"line":43,"column":19},"generated":{"line":1,"column":1137}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":1141}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":1142}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":1146}},{"source":"core_modules/web_socket.js","original":{"line":49,"column":19},"generated":{"line":1,"column":1161}},{"source":"core_modules/web_socket.js","original":{"line":49,"column":19},"generated":{"line":1,"column":1167}},{"source":"core_modules/web_socket.js","name":"send_json","original":{"line":50,"column":6},"generated":{"line":1,"column":1178}},{"source":"core_modules/web_socket.js","name":"send_json","original":{"line":50,"column":6},"generated":{"line":1,"column":1183}},{"source":"core_modules/web_socket.js","original":{"line":50,"column":16},"generated":{"line":1,"column":1193}},{"source":"core_modules/web_socket.js","name":"type","original":{"line":50,"column":17},"generated":{"line":1,"column":1194}},{"source":"core_modules/web_socket.js","original":{"line":50,"column":24},"generated":{"line":1,"column":1199}},{"source":"core_modules/web_socket.js","name":"data","original":{"line":50,"column":36},"generated":{"line":1,"column":1209}},{"source":"core_modules/web_socket.js","original":{"line":50,"column":43},"generated":{"line":1,"column":1214}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":1226}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":1227}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":1231}},{"source":"core_modules/web_socket.js","original":{"line":56,"column":18},"generated":{"line":1,"column":1245}},{"source":"core_modules/web_socket.js","original":{"line":56,"column":18},"generated":{"line":1,"column":1251}},{"source":"core_modules/web_socket.js","name":"send_json","original":{"line":57,"column":6},"generated":{"line":1,"column":1262}},{"source":"core_modules/web_socket.js","name":"send_json","original":{"line":57,"column":6},"generated":{"line":1,"column":1267}},{"source":"core_modules/web_socket.js","original":{"line":57,"column":16},"generated":{"line":1,"column":1277}},{"source":"core_modules/web_socket.js","name":"type","original":{"line":57,"column":17},"generated":{"line":1,"column":1278}},{"source":"core_modules/web_socket.js","original":{"line":57,"column":24},"generated":{"line":1,"column":1283}},{"source":"core_modules/web_socket.js","name":"data","original":{"line":57,"column":36},"generated":{"line":1,"column":1293}},{"source":"core_modules/web_socket.js","original":{"line":57,"column":43},"generated":{"line":1,"column":1298}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":1309}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":1310}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":1314}},{"source":"core_modules/web_socket.js","name":"func","original":{"line":64,"column":21},"generated":{"line":1,"column":1333}},{"source":"core_modules/web_socket.js","name":"func","original":{"line":64,"column":21},"generated":{"line":1,"column":1339}},{"source":"core_modules/web_socket.js","name":"func","original":{"line":64,"column":21},"generated":{"line":1,"column":1348}},{"source":"core_modules/web_socket.js","name":"data_handler","original":{"line":65,"column":6},"generated":{"line":1,"column":1351}},{"source":"core_modules/web_socket.js","name":"data_handler","original":{"line":65,"column":6},"generated":{"line":1,"column":1356}},{"source":"core_modules/web_socket.js","name":"func","original":{"line":65,"column":21},"generated":{"line":1,"column":1369}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":1373}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":1374}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":1378}},{"source":"core_modules/web_socket.js","name":"obj","original":{"line":72,"column":14},"generated":{"line":1,"column":1390}},{"source":"core_modules/web_socket.js","name":"obj","original":{"line":72,"column":14},"generated":{"line":1,"column":1396}},{"source":"core_modules/web_socket.js","name":"obj","original":{"line":72,"column":14},"generated":{"line":1,"column":1405}},{"source":"core_modules/web_socket.js","name":"connection","original":{"line":73,"column":6},"generated":{"line":1,"column":1408}},{"source":"core_modules/web_socket.js","name":"connection","original":{"line":73,"column":6},"generated":{"line":1,"column":1413}},{"source":"core_modules/web_socket.js","name":"send","original":{"line":73,"column":17},"generated":{"line":1,"column":1424}},{"source":"core_modules/web_socket.js","name":"JSON","original":{"line":73,"column":22},"generated":{"line":1,"column":1429}},{"source":"core_modules/web_socket.js","name":"stringify","original":{"line":73,"column":27},"generated":{"line":1,"column":1434}},{"source":"core_modules/web_socket.js","name":"obj","original":{"line":73,"column":37},"generated":{"line":1,"column":1444}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":1452}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":1454}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":1457}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":1465}},{"source":"core_modules/web_socket.js","original":{"line":74,"column":5},"generated":{"line":1,"column":1473}}],"sources":{"core_modules/web_socket.js":"// Sat Sep 29 18:31:15 PDT 2018\n\nimport {makeLogger} from \"./logger.js\"\nimport {util} from \"../module_resources/utils.js\"\n\n/**\n * Manages the websocket connection to an incoming data stream.\n *\n * @param {String} url - The websocket url to connect to, e.g. ws://localhost:1234\n */\nexport default class web_socket {\n    \n    constructor(url) { \n\tthis.url = url ;  \n\tthis.connection = null ;  \n\tthis.log = makeLogger(\"WS\")\n\tthis.default_handler = function(data) { \n\t    this.log(\"No data handler has been defined!\") \n\t} \n\tthis.data_handler = this.default_handler \n    } \n    \n    /**\n     * Connect to remote websocket server. Upon success, registers the websocket connection\n     * as \"client\" with the server, enables streaming, and this.logs to console. \n     */ \n    connect() { \n\tvar conn  = new WebSocket(this.url) ; \n\t// Connection opened\n\tconn.addEventListener('open', (function (event) {\n\t    this.log(\"Connection to \" + this.url + \" successful. Registering client with server.\")\n\t    this.send_json({type: \"register\" , data : \"client\" })\n\t    this.send_json({type: \"control\"  , data : \"start\"  }) \n\t}).bind(this)) //bind is necessary for web_socket class vs WebSocket instance! \n\n\t\n\t// Listen for messages\n\tconn.addEventListener('message', (function (event) {\n\t    //this.log(\"Received msg: \" + event.data) \n\t    this.data_handler(util.dict_vals_2_num(JSON.parse(event.data))) //parse json and convert nums\n\t}).bind(this)) //bind is necessary for web_socket class vs WebSocket instance! \n\t\n\tthis.connection = conn ; \n    } \n    \n    /** \n     * Start accepting incoming raw data objects.\n     */ \n    start_stream() { \n\tthis.send_json({type : \"control\" , data : \"start\" } ) \n    }\n\n    /** \n     * Stop accepting incoming raw data objects.\n     */ \n    stop_stream() { \n\tthis.send_json({type : \"control\" , data : \"stop\" } ) \n    }\n\n    /** \n     * Sets the data_handler attribute, which determines what the socket does to incomin data.\n     * @param {Function} func - Function which accepts ONE raw data object {..} and processes it.\n     */ \n    set_data_handler(func) { \n\tthis.data_handler = func ; \n    }\n\n    /** \n     * Sends JSON data through socket. \n     * @param {Object} obj - Data object to send \n     */ \n    send_json(obj) { \n\tthis.connection.send(JSON.stringify(obj))\n    }\n\n    \n    \n}\n\n"},"lineCount":null}},"hash":"bb526352a703994b61c7ab4a39ec197b","cacheData":{"env":{}}}